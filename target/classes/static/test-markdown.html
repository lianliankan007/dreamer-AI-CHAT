<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdownæµ‹è¯•é¡µé¢</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/markdown.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <style>
        body {
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-input {
            width: 100%;
            height: 200px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
        }
        .test-output {
            margin-top: 10px;
            padding: 15px;
            border: 1px solid #e1e4e8;
            border-radius: 4px;
            background-color: #f8f9fa;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .debug {
            background: #f1f3f4;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ MarkdownåŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="test-section">
            <h2>æµ‹è¯•è¾“å…¥</h2>
            <textarea id="testInput" class="test-input" placeholder="åœ¨è¿™é‡Œè¾“å…¥Markdownå†…å®¹è¿›è¡Œæµ‹è¯•...">
# æ ‡é¢˜æµ‹è¯•
## äºŒçº§æ ‡é¢˜
### ä¸‰çº§æ ‡é¢˜

**ç²—ä½“æ–‡æœ¬** å’Œ *æ–œä½“æ–‡æœ¬*

`è¡Œå†…ä»£ç ç¤ºä¾‹`

```javascript
function sayHello(name) {
    console.log(`Hello, ${name}!`);
    return `æ¬¢è¿ï¼Œ${name}ï¼`;
}
```

> è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨å—
> å¯ä»¥åŒ…å«å¤šè¡Œå†…å®¹

æ— åºåˆ—è¡¨ï¼š
- ç¬¬ä¸€é¡¹
- ç¬¬äºŒé¡¹
- ç¬¬ä¸‰é¡¹

æœ‰åºåˆ—è¡¨ï¼š
1. æ­¥éª¤ä¸€
2. æ­¥éª¤äºŒ
3. æ­¥éª¤ä¸‰

[é“¾æ¥ç¤ºä¾‹](https://github.com)

---

è¡¨æ ¼ç¤ºä¾‹ï¼š

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| æ ‡é¢˜ | âœ… | æ”¯æŒ1-6çº§æ ‡é¢˜ |
| å¼ºè°ƒ | âœ… | ç²—ä½“å’Œæ–œä½“ |
| ä»£ç  | âœ… | è¡Œå†…å’Œå—çº§ä»£ç  |
| åˆ—è¡¨ | âœ… | æœ‰åºå’Œæ— åºåˆ—è¡¨ |

~~åˆ é™¤çº¿æ–‡æœ¬~~
            </textarea>
            
            <button class="btn" onclick="testMarkdown()">ğŸš€ æµ‹è¯•æ¸²æŸ“</button>
            <button class="btn" onclick="clearOutput()">ğŸ§¹ æ¸…ç©ºè¾“å‡º</button>
            <button class="btn" onclick="checkLibraries()">ğŸ” æ£€æŸ¥åº“çŠ¶æ€</button>
        </div>
        
        <div class="test-section">
            <h2>è°ƒè¯•ä¿¡æ¯</h2>
            <div id="debugInfo" class="debug">ç­‰å¾…æµ‹è¯•...</div>
        </div>
        
        <div class="test-section">
            <h2>æ¸²æŸ“ç»“æœ</h2>
            <div id="testOutput" class="test-output message-text">
                ç­‰å¾…æ¸²æŸ“...
            </div>
        </div>
    </div>

    <!-- JavaScriptåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
    
    <!-- èŠå¤©ç®¡ç†å™¨ï¼ˆç”¨äºæµ‹è¯•formatContentæ–¹æ³•ï¼‰ -->
    <script src="js/chat-simple.js"></script>
    
    <script>
        let chatManager;
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', () => {
            setTimeout(() => {
                chatManager = new SimpleChatManager();
                checkLibraries();
            }, 1000);
        });
        
        function testMarkdown() {
            const input = document.getElementById('testInput').value;
            const output = document.getElementById('testOutput');
            const debug = document.getElementById('debugInfo');
            
            debug.innerHTML = 'å¼€å§‹æµ‹è¯•...\n';
            
            try {
                if (chatManager) {
                    const result = chatManager.formatContent(input);
                    output.innerHTML = result;
                    
                    // åº”ç”¨ä»£ç é«˜äº®
                    chatManager.highlightCodeBlocks(output);
                    
                    debug.innerHTML += `âœ… æµ‹è¯•æˆåŠŸ\nåŸæ–‡é•¿åº¦: ${input.length}\nç»“æœé•¿åº¦: ${result.length}\n\næ¸²æŸ“HTML:\n${result.substring(0, 500)}${result.length > 500 ? '...' : ''}`;
                } else {
                    throw new Error('èŠå¤©ç®¡ç†å™¨æœªåˆå§‹åŒ–');
                }
            } catch (error) {
                debug.innerHTML += `âŒ æµ‹è¯•å¤±è´¥: ${error.message}\n`;
                output.innerHTML = `<p style="color: red;">æ¸²æŸ“å¤±è´¥: ${error.message}</p>`;
            }
        }
        
        function clearOutput() {
            document.getElementById('testOutput').innerHTML = 'ç­‰å¾…æ¸²æŸ“...';
            document.getElementById('debugInfo').innerHTML = 'å·²æ¸…ç©º...';
        }
        
        function checkLibraries() {
            const debug = document.getElementById('debugInfo');
            let info = 'ğŸ“š åº“çŠ¶æ€æ£€æŸ¥:\n\n';
            
            info += `marked.js: ${typeof window.marked} ${window.marked ? 'âœ…' : 'âŒ'}\n`;
            info += `Prism.js: ${typeof window.Prism} ${window.Prism ? 'âœ…' : 'âŒ'}\n`;
            info += `SimpleChatManager: ${typeof window.SimpleChatManager} ${window.SimpleChatManager ? 'âœ…' : 'âŒ'}\n`;
            info += `èŠå¤©ç®¡ç†å™¨å®ä¾‹: ${chatManager ? 'âœ…' : 'âŒ'}\n\n`;
            
            if (window.marked) {
                info += `markedç‰ˆæœ¬: ${window.marked.version || 'æœªçŸ¥'}\n`;
                info += `markedç±»å‹: ${typeof window.marked}\n`;
            }
            
            if (window.Prism) {
                info += `Prismè¯­è¨€æ”¯æŒ: ${Object.keys(window.Prism.languages || {}).join(', ')}\n`;
            }
            
            debug.innerHTML = info;
        }
        
        // å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'Enter') {
                testMarkdown();
            }
        });
    </script>
</body>
</html> 